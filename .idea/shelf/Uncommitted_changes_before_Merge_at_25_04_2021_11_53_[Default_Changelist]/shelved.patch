Index: main.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import math\r\n\r\nfrom telegram.ext import Updater, CommandHandler, MessageHandler, Filters\r\nfrom telegram import ReplyKeyboardMarkup\r\nfrom telegram import ReplyKeyboardRemove\r\n\r\nTOKEN = '1736386615:AAF05MwBL5U82e_0n0h9lv1jSfhFnk9qI4Q'\r\n\r\na = 0\r\nb = 0\r\nc = 0\r\naction = 0\r\n\r\n\r\ndef main():\r\n    global dp\r\n    updater = Updater(TOKEN, use_context=True)\r\n    dp = updater.dispatcher\r\n    dp.add_handler(CommandHandler(\"start\", start))\r\n    dp.add_handler(CommandHandler(\"equations\", equations))\r\n    dp.add_handler(MessageHandler(Filters.text, decision))\r\n\r\n    updater.start_polling()\r\n    updater.idle()\r\n\r\n\r\ndef start(update, context):\r\n    reply_keyboard = [['/equations']]\r\n    markup = ReplyKeyboardMarkup(reply_keyboard, one_time_keyboard=False)\r\n    update.message.reply_text('Как этот бот может вам помочь?', reply_markup=markup)\r\n\r\n\r\ndef equations(update, context):\r\n    global action\r\n    update.message.reply_text(\"Введите коэффициенты для уравнения\", reply_markup=ReplyKeyboardRemove())\r\n    update.message.reply_text(\"ax^2 + bx + c = 0:\")\r\n    update.message.reply_text(\"a = \")\r\n\r\n\r\ndef check_a(update):\r\n    global a, b, c, action\r\n    num = '1234567890-.,'\r\n    flag_2 = True\r\n    a = update.message.text\r\n    a = str(a)\r\n    for i in a:\r\n        if i not in num and action == 0 and flag_2:\r\n            update.message.reply_text(\"Вы некорректно ввели первый коэффициент\")\r\n            update.message.reply_text(\"a = \")\r\n            flag_2 = False\r\n    if flag_2:\r\n        action += 1\r\n    decision()\r\n\r\n\r\ndef check_b(update):\r\n    global a, b, c, action\r\n    num = '1234567890-.,'\r\n    flag_2 = True\r\n    b = update.message.text\r\n    b = str(b)\r\n    for i in b:\r\n        if i not in num and action == 1 and flag_2:\r\n            update.message.reply_text(\"Вы некорректно ввели второй коэффициент\")\r\n            update.message.reply_text(\"b = \")\r\n            flag_2 = False\r\n    if flag_2:\r\n        action += 1\r\n    decision()\r\n\r\n\r\ndef check_c(update):\r\n    global a, b, c, action\r\n    num = '1234567890-.,'\r\n    flag_2 = True\r\n    c = update.message.text\r\n    c = str(c)\r\n    for i in c:\r\n        if i not in num and action == 2 and flag_2:\r\n            update.message.reply_text(\"Вы некорректно ввели третий коэффициент\")\r\n            update.message.reply_text(\"c = \")\r\n            flag_2 = False\r\n    if flag_2:\r\n        action += 1\r\n    decision()\r\n\r\n\r\ndef restart():\r\n    dp.add_handler(MessageHandler(Filters.text, decision))\r\n\r\n\r\ndef decision(update, context):\r\n    global a, b, c, action, dp\r\n    num = '1234567890-.,'\r\n    flag_2 = True\r\n    if action == 0:\r\n        a = update.message.text\r\n        a_new = update.message.text\r\n        a = str(a)\r\n        for i in a:\r\n            if i not in num and action == 0 and flag_2:\r\n                update.message.reply_text(\"Вы некорректно ввели первый коэффициент\")\r\n                update.message.reply_text(\"a = \")\r\n                flag_2 = False\r\n        a_new = update.message.text\r\n        if a == a_new and not flag_2:\r\n            dp.add_handler(MessageHandler(Filters.text, check_a))\r\n        elif action == 0:\r\n            action += 1\r\n            update.message.reply_text(\"b = \")\r\n            restart()\r\n\r\n    elif action == 1:\r\n\r\n        b = update.message.text\r\n        b_new = update.message.text\r\n        b = str(b)\r\n        for i in b:\r\n            if i not in num and action == 1 and flag_2:\r\n                update.message.reply_text(\"Вы некорректно ввели второй коэффициент\")\r\n                update.message.reply_text(\"b = \")\r\n                flag_2 = False\r\n        b_new = update.message.text\r\n        if b == b_new and not flag_2:\r\n            dp.add_handler(MessageHandler(Filters.text, check_b))\r\n        elif action == 1:\r\n            action += 1\r\n            update.message.reply_text(\"c = \")\r\n            restart()\r\n\r\n    elif action == 2:\r\n        c = update.message.text\r\n        c_new = update.message.text\r\n        c = str(c)\r\n        for i in c:\r\n            if i not in num and action == 2 and flag_2:\r\n                update.message.reply_text(\"Вы некорректно ввели третий коэффициент\")\r\n                update.message.reply_text(\"c = \")\r\n                flag_2 = False\r\n        c_new = update.message.text\r\n        if c == c_new and not flag_2:\r\n            dp.add_handler(MessageHandler(Filters.text, check_c))\r\n        elif action == 2:\r\n            action += 1\r\n\r\n    if action == 3:\r\n        a = float(a)\r\n        b = float(b)\r\n        c = float(c)\r\n        discr = b ** 2 - 4 * a * c\r\n        update.message.reply_text(f\"Дискриминант D = {discr}\")\r\n        print(a, b, c)\r\n        if discr > 0:\r\n            x1 = (-b + math.sqrt(discr)) / (2 * a)\r\n            x2 = (-b - math.sqrt(discr)) / (2 * a)\r\n            update.message.reply_text(\"x1 = %.2f \\nx2 = %.2f\" % (x1, x2))\r\n        elif discr == 0:\r\n            x = -b / (2 * a)\r\n            update.message.reply_text(\"x = %.2f\" % x)\r\n        else:\r\n            update.message.reply_text(\"Корней нет\")\r\n        action = 0\r\n\r\n        reply_keyboard = [['/start']]\r\n        markup = ReplyKeyboardMarkup(reply_keyboard, one_time_keyboard=False)\r\n        update.message.reply_text('...', reply_markup=markup)\r\n\r\n\r\n# Запускаем функцию main() в случае запуска скрипта.\r\nif __name__ == '__main__':\r\n    main()\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- main.py	(revision 367af130197bd1fd22c714110e4c53bd38b17e0c)
+++ main.py	(date 1619340530834)
@@ -4,7 +4,7 @@
 from telegram import ReplyKeyboardMarkup
 from telegram import ReplyKeyboardRemove
 
-TOKEN = '1736386615:AAF05MwBL5U82e_0n0h9lv1jSfhFnk9qI4Q'
+TOKEN = '1678923601:AAHs2GdKvsjcixPC9S4C1e9y2C78Z23-V80'
 
 a = 0
 b = 0
@@ -163,7 +163,7 @@
 
         reply_keyboard = [['/start']]
         markup = ReplyKeyboardMarkup(reply_keyboard, one_time_keyboard=False)
-        update.message.reply_text('...', reply_markup=markup)
+        update.message.reply_text('Конец работы.', reply_markup=markup)
 
 
 # Запускаем функцию main() в случае запуска скрипта.
